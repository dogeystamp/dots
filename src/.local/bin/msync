#!/bin/sh

# Use go-mtpfs to sync files from an Android device

set -e

while getopts ":pr" o; do
	case "${o}" in
		p) ACTION=PUSH ;;
		r) ACTION=RECV ;;
	esac
done

ROOT="$HOME/quar/mnt/Internal shared storage"

go-mtpfs "$ROOT" &

# General rsync options
OPTS="-avPc"

if [ $ACTION = PUSH ]
then
	# Optionally send sorted files back

	rsync $OPTS ~/med/memes/woof/ "$ROOT/Pictures/memes"
	rsync $OPTS ~/med/rw/sch/ "$ROOT/Pictures/rw/sch"
	rsync $OPTS ~/med/sticker/ "$ROOT/Pictures/sticker"
fi

# Options for all receive rsync transfers
ROPTS="--remove-source-files"

if [ $ACTION = RECV ]
then
	# Move files to the quarantine zone for categorisation and renaming

	rsync $OPTS $ROPTS "$ROOT/Pictures/Infinity/" ~/quar

	rsync $OPTS $ROPTS "$ROOT/Movies/Infinity/" ~/quar

	rsync $OPTS $ROPTS "$ROOT/DCIM/OpenCamera/" ~/quar
	rsync $OPTS $ROPTS "$ROOT/DCIM/Camera/" ~/quar

	rsync $OPTS $ROPTS "$ROOT/Recordings/Sound records/" ~/quar

	rsync $OPTS $ROPTS "$ROOT/Documents/dr" ~/quar
fi
